python test_RAP_hiarchical.py -m hiarBayesGoogLeNet_gap_v3 -c 51 -w 320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50 -g 1 -s 0
The shape of the X_test is:  (8317,)
The shape of the y_test is:  (8317, 51)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 320, 120, 3)  0                                            
__________________________________________________________________________________________________
conv1_7x7_s2 (Conv2D)           (None, 160, 60, 64)  9472        input_1[0][0]                    
__________________________________________________________________________________________________
conv1_7x7_s2_bn (BatchNormaliza (None, 160, 60, 64)  256         conv1_7x7_s2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 80, 30, 64)   0           conv1_7x7_s2_bn[0][0]            
__________________________________________________________________________________________________
conv2_3x3 (Conv2D)              (None, 80, 30, 192)  110784      max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_3x3_bn (BatchNormalizatio (None, 80, 30, 192)  768         conv2_3x3[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 40, 15, 192)  0           conv2_3x3_bn[0][0]               
__________________________________________________________________________________________________
inception_3a_3x3_reduce (Conv2D (None, 40, 15, 96)   18528       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a5x5_reduce (Conv2D) (None, 40, 15, 16)   3088        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_reduce_bn (Bat (None, 40, 15, 96)   384         inception_3a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3a5x5_reduce_bn (Batc (None, 40, 15, 16)   64          inception_3a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 15, 192)  0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1 (Conv2D)       (None, 40, 15, 64)   12352       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3 (Conv2D)       (None, 40, 15, 128)  110720      inception_3a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3a_5x5 (Conv2D)       (None, 40, 15, 32)   12832       inception_3a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3a_pool_proj (Conv2D) (None, 40, 15, 32)   6176        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1_bn (BatchNorma (None, 40, 15, 64)   256         inception_3a_1x1[0][0]           
__________________________________________________________________________________________________
inception_3a_3x3_bn (BatchNorma (None, 40, 15, 128)  512         inception_3a_3x3[0][0]           
__________________________________________________________________________________________________
inception_3a_5x5_bn (BatchNorma (None, 40, 15, 32)   128         inception_3a_5x5[0][0]           
__________________________________________________________________________________________________
inception_3a_pool_proj_bn (Batc (None, 40, 15, 32)   128         inception_3a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 15, 256)  0           inception_3a_1x1_bn[0][0]        
                                                                 inception_3a_3x3_bn[0][0]        
                                                                 inception_3a_5x5_bn[0][0]        
                                                                 inception_3a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_3x3_reduce (Conv2D (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b5x5_reduce (Conv2D) (None, 40, 15, 32)   8224        concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3_reduce_bn (Bat (None, 40, 15, 128)  512         inception_3b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3b5x5_reduce_bn (Batc (None, 40, 15, 32)   128         inception_3b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 40, 15, 256)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_1x1 (Conv2D)       (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3 (Conv2D)       (None, 40, 15, 192)  221376      inception_3b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3b_5x5 (Conv2D)       (None, 40, 15, 96)   76896       inception_3b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_pool_proj (Conv2D) (None, 40, 15, 64)   16448       max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
inception_3b_1x1_bn (BatchNorma (None, 40, 15, 128)  512         inception_3b_1x1[0][0]           
__________________________________________________________________________________________________
inception_3b_3x3_bn (BatchNorma (None, 40, 15, 192)  768         inception_3b_3x3[0][0]           
__________________________________________________________________________________________________
inception_3b_5x5_bn (BatchNorma (None, 40, 15, 96)   384         inception_3b_5x5[0][0]           
__________________________________________________________________________________________________
inception_3b_pool_proj_bn (Batc (None, 40, 15, 64)   256         inception_3b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 15, 480)  0           inception_3b_1x1_bn[0][0]        
                                                                 inception_3b_3x3_bn[0][0]        
                                                                 inception_3b_5x5_bn[0][0]        
                                                                 inception_3b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 20, 8, 480)   0           concatenate_2[0][0]              
__________________________________________________________________________________________________
inception_4a_3x3_reduce (Conv2D (None, 20, 8, 96)    46176       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a5x5_reduce (Conv2D) (None, 20, 8, 16)    7696        max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3_reduce_bn (Bat (None, 20, 8, 96)    384         inception_4a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4a5x5_reduce_bn (Batc (None, 20, 8, 16)    64          inception_4a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)  (None, 20, 8, 480)   0           max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1 (Conv2D)       (None, 20, 8, 192)   92352       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3 (Conv2D)       (None, 20, 8, 208)   179920      inception_4a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4a_5x5 (Conv2D)       (None, 20, 8, 48)    19248       inception_4a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4a_pool_proj (Conv2D) (None, 20, 8, 64)    30784       max_pooling2d_6[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1_bn (BatchNorma (None, 20, 8, 192)   768         inception_4a_1x1[0][0]           
__________________________________________________________________________________________________
inception_4a_3x3_bn (BatchNorma (None, 20, 8, 208)   832         inception_4a_3x3[0][0]           
__________________________________________________________________________________________________
inception_4a_5x5_bn (BatchNorma (None, 20, 8, 48)    192         inception_4a_5x5[0][0]           
__________________________________________________________________________________________________
inception_4a_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 20, 8, 512)   0           inception_4a_1x1_bn[0][0]        
                                                                 inception_4a_3x3_bn[0][0]        
                                                                 inception_4a_5x5_bn[0][0]        
                                                                 inception_4a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_3x3_reduce (Conv2D (None, 20, 8, 112)   57456       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3_reduce_bn (Bat (None, 20, 8, 112)   448         inception_4b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4b5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_1x1 (Conv2D)       (None, 20, 8, 160)   82080       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3 (Conv2D)       (None, 20, 8, 224)   226016      inception_4b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4b_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_7[0][0]            
__________________________________________________________________________________________________
inception_4b_1x1_bn (BatchNorma (None, 20, 8, 160)   640         inception_4b_1x1[0][0]           
__________________________________________________________________________________________________
inception_4b_3x3_bn (BatchNorma (None, 20, 8, 224)   896         inception_4b_3x3[0][0]           
__________________________________________________________________________________________________
inception_4b_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4b_5x5[0][0]           
__________________________________________________________________________________________________
inception_4b_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 20, 8, 512)   0           inception_4b_1x1_bn[0][0]        
                                                                 inception_4b_3x3_bn[0][0]        
                                                                 inception_4b_5x5_bn[0][0]        
                                                                 inception_4b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_3x3_reduce (Conv2D (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3_reduce_bn (Bat (None, 20, 8, 128)   512         inception_4c_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4c5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4c5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_1x1 (Conv2D)       (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3 (Conv2D)       (None, 20, 8, 256)   295168      inception_4c_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4c_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4c5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_8[0][0]            
__________________________________________________________________________________________________
inception_4c_1x1_bn (BatchNorma (None, 20, 8, 128)   512         inception_4c_1x1[0][0]           
__________________________________________________________________________________________________
inception_4c_3x3_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4c_3x3[0][0]           
__________________________________________________________________________________________________
inception_4c_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4c_5x5[0][0]           
__________________________________________________________________________________________________
inception_4c_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4c_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 20, 8, 512)   0           inception_4c_1x1_bn[0][0]        
                                                                 inception_4c_3x3_bn[0][0]        
                                                                 inception_4c_5x5_bn[0][0]        
                                                                 inception_4c_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_3x3_reduce (Conv2D (None, 20, 8, 144)   73872       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d5x5_reduce (Conv2D) (None, 20, 8, 32)    16416       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3_reduce_bn (Bat (None, 20, 8, 144)   576         inception_4d_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4d5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4d5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_9 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_1x1 (Conv2D)       (None, 20, 8, 112)   57456       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3 (Conv2D)       (None, 20, 8, 288)   373536      inception_4d_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4d_5x5 (Conv2D)       (None, 20, 8, 64)    51264       inception_4d5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_9[0][0]            
__________________________________________________________________________________________________
inception_4d_1x1_bn (BatchNorma (None, 20, 8, 112)   448         inception_4d_1x1[0][0]           
__________________________________________________________________________________________________
inception_4d_3x3_bn (BatchNorma (None, 20, 8, 288)   1152        inception_4d_3x3[0][0]           
__________________________________________________________________________________________________
inception_4d_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4d_5x5[0][0]           
__________________________________________________________________________________________________
inception_4d_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4d_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 20, 8, 528)   0           inception_4d_1x1_bn[0][0]        
                                                                 inception_4d_3x3_bn[0][0]        
                                                                 inception_4d_5x5_bn[0][0]        
                                                                 inception_4d_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_3x3_reduce (Conv2D (None, 20, 8, 160)   84640       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e5x5_reduce (Conv2D) (None, 20, 8, 32)    16928       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_reduce_bn (Bat (None, 20, 8, 160)   640         inception_4e_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4e5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4e5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 20, 8, 528)   0           concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_1x1 (Conv2D)       (None, 20, 8, 256)   135424      concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3 (Conv2D)       (None, 20, 8, 320)   461120      inception_4e_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4e_5x5 (Conv2D)       (None, 20, 8, 128)   102528      inception_4e5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_pool_proj (Conv2D) (None, 20, 8, 128)   67712       max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
inception_4e_1x1_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4e_1x1[0][0]           
__________________________________________________________________________________________________
inception_4e_3x3_bn (BatchNorma (None, 20, 8, 320)   1280        inception_4e_3x3[0][0]           
__________________________________________________________________________________________________
inception_4e_5x5_bn (BatchNorma (None, 20, 8, 128)   512         inception_4e_5x5[0][0]           
__________________________________________________________________________________________________
inception_4e_pool_proj_bn (Batc (None, 20, 8, 128)   512         inception_4e_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 20, 8, 832)   0           inception_4e_1x1_bn[0][0]        
                                                                 inception_4e_3x3_bn[0][0]        
                                                                 inception_4e_5x5_bn[0][0]        
                                                                 inception_4e_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_7[0][0]              
__________________________________________________________________________________________________
inception_5a_3x3_reduce (Conv2D (None, 10, 4, 160)   133280      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a5x5_reduce (Conv2D) (None, 10, 4, 32)    26656       max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_reduce_bn (Bat (None, 10, 4, 160)   640         inception_5a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5a5x5_reduce_bn (Batc (None, 10, 4, 32)    128         inception_5a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 10, 4, 832)   0           max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1 (Conv2D)       (None, 10, 4, 256)   213248      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3 (Conv2D)       (None, 10, 4, 320)   461120      inception_5a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5a_5x5 (Conv2D)       (None, 10, 4, 128)   102528      inception_5a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5a_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1_bn (BatchNorma (None, 10, 4, 256)   1024        inception_5a_1x1[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_bn (BatchNorma (None, 10, 4, 320)   1280        inception_5a_3x3[0][0]           
__________________________________________________________________________________________________
inception_5a_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5a_5x5[0][0]           
__________________________________________________________________________________________________
inception_5a_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 10, 4, 832)   0           inception_5a_1x1_bn[0][0]        
                                                                 inception_5a_3x3_bn[0][0]        
                                                                 inception_5a_5x5_bn[0][0]        
                                                                 inception_5a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_3x3_reduce (Conv2D (None, 10, 4, 192)   159936      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b5x5_reduce (Conv2D) (None, 10, 4, 48)    39984       concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3_reduce_bn (Bat (None, 10, 4, 192)   768         inception_5b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5b5x5_reduce_bn (Batc (None, 10, 4, 48)    192         inception_5b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1 (Conv2D)       (None, 10, 4, 384)   319872      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3 (Conv2D)       (None, 10, 4, 384)   663936      inception_5b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5b_5x5 (Conv2D)       (None, 10, 4, 128)   153728      inception_5b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 20, 8, 512)   2359808     concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_1x1[0][0]           
__________________________________________________________________________________________________
inception_5b_3x3_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_3x3[0][0]           
__________________________________________________________________________________________________
inception_5b_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5b_5x5[0][0]           
__________________________________________________________________________________________________
inception_5b_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5b_pool_proj[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 512)          0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 512)          0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 512)          0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 512)          0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 512)          0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 512)          0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 512)          0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 10, 4, 1024)  0           inception_5b_1x1_bn[0][0]        
                                                                 inception_5b_3x3_bn[0][0]        
                                                                 inception_5b_5x5_bn[0][0]        
                                                                 inception_5b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
low (Dense)                     (None, 3)            1539        global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
middle_hs (Dense)               (None, 3)            1539        global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
middle_ub (Dense)               (None, 9)            4617        global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
middle_lb (Dense)               (None, 6)            3078        global_average_pooling2d_4[0][0] 
__________________________________________________________________________________________________
middle_sh (Dense)               (None, 5)            2565        global_average_pooling2d_5[0][0] 
__________________________________________________________________________________________________
middle_at (Dense)               (None, 8)            4104        global_average_pooling2d_6[0][0] 
__________________________________________________________________________________________________
middle_ot (Dense)               (None, 3)            1539        global_average_pooling2d_7[0][0] 
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 10, 4, 1024)  9438208     concatenate_9[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 37)           0           low[0][0]                        
                                                                 middle_hs[0][0]                  
                                                                 middle_ub[0][0]                  
                                                                 middle_lb[0][0]                  
                                                                 middle_sh[0][0]                  
                                                                 middle_at[0][0]                  
                                                                 middle_ot[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 1024)         0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
high_cond (Dense)               (None, 14)           532         concatenate_10[0][0]             
__________________________________________________________________________________________________
high_fea (Dense)                (None, 14)           14350       global_average_pooling2d_8[0][0] 
__________________________________________________________________________________________________
high (Lambda)                   (None, 14)           0           high_cond[0][0]                  
                                                                 high_fea[0][0]                   
==================================================================================================
Total params: 32,431,351
Trainable params: 32,416,919
Non-trainable params: 14,432
__________________________________________________________________________________________________
320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_(e|f)1*
['320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch02_valloss3.06.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch01_valloss3.36.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch03_valloss2.95.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch05_valloss2.92.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch06_valloss2.87.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_final50iter_model.h5']
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch02_valloss3.06.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch01_valloss3.36.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch03_valloss2.95.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch05_valloss2.92.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_epoch06_valloss2.87.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split0_iter50_final50iter_model.h5_predictions_imagenet_test_RAP.npy
python test_RAP_hiarchical.py -m hiarBayesGoogLeNet_gap_v3 -c 51 -w 320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50 -g 1 -s 1
The shape of the X_test is:  (8317,)
The shape of the y_test is:  (8317, 51)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 320, 120, 3)  0                                            
__________________________________________________________________________________________________
conv1_7x7_s2 (Conv2D)           (None, 160, 60, 64)  9472        input_1[0][0]                    
__________________________________________________________________________________________________
conv1_7x7_s2_bn (BatchNormaliza (None, 160, 60, 64)  256         conv1_7x7_s2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 80, 30, 64)   0           conv1_7x7_s2_bn[0][0]            
__________________________________________________________________________________________________
conv2_3x3 (Conv2D)              (None, 80, 30, 192)  110784      max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_3x3_bn (BatchNormalizatio (None, 80, 30, 192)  768         conv2_3x3[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 40, 15, 192)  0           conv2_3x3_bn[0][0]               
__________________________________________________________________________________________________
inception_3a_3x3_reduce (Conv2D (None, 40, 15, 96)   18528       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a5x5_reduce (Conv2D) (None, 40, 15, 16)   3088        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_reduce_bn (Bat (None, 40, 15, 96)   384         inception_3a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3a5x5_reduce_bn (Batc (None, 40, 15, 16)   64          inception_3a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 15, 192)  0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1 (Conv2D)       (None, 40, 15, 64)   12352       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3 (Conv2D)       (None, 40, 15, 128)  110720      inception_3a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3a_5x5 (Conv2D)       (None, 40, 15, 32)   12832       inception_3a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3a_pool_proj (Conv2D) (None, 40, 15, 32)   6176        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1_bn (BatchNorma (None, 40, 15, 64)   256         inception_3a_1x1[0][0]           
__________________________________________________________________________________________________
inception_3a_3x3_bn (BatchNorma (None, 40, 15, 128)  512         inception_3a_3x3[0][0]           
__________________________________________________________________________________________________
inception_3a_5x5_bn (BatchNorma (None, 40, 15, 32)   128         inception_3a_5x5[0][0]           
__________________________________________________________________________________________________
inception_3a_pool_proj_bn (Batc (None, 40, 15, 32)   128         inception_3a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 15, 256)  0           inception_3a_1x1_bn[0][0]        
                                                                 inception_3a_3x3_bn[0][0]        
                                                                 inception_3a_5x5_bn[0][0]        
                                                                 inception_3a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_3x3_reduce (Conv2D (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b5x5_reduce (Conv2D) (None, 40, 15, 32)   8224        concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3_reduce_bn (Bat (None, 40, 15, 128)  512         inception_3b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3b5x5_reduce_bn (Batc (None, 40, 15, 32)   128         inception_3b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 40, 15, 256)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_1x1 (Conv2D)       (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3 (Conv2D)       (None, 40, 15, 192)  221376      inception_3b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3b_5x5 (Conv2D)       (None, 40, 15, 96)   76896       inception_3b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_pool_proj (Conv2D) (None, 40, 15, 64)   16448       max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
inception_3b_1x1_bn (BatchNorma (None, 40, 15, 128)  512         inception_3b_1x1[0][0]           
__________________________________________________________________________________________________
inception_3b_3x3_bn (BatchNorma (None, 40, 15, 192)  768         inception_3b_3x3[0][0]           
__________________________________________________________________________________________________
inception_3b_5x5_bn (BatchNorma (None, 40, 15, 96)   384         inception_3b_5x5[0][0]           
__________________________________________________________________________________________________
inception_3b_pool_proj_bn (Batc (None, 40, 15, 64)   256         inception_3b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 15, 480)  0           inception_3b_1x1_bn[0][0]        
                                                                 inception_3b_3x3_bn[0][0]        
                                                                 inception_3b_5x5_bn[0][0]        
                                                                 inception_3b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 20, 8, 480)   0           concatenate_2[0][0]              
__________________________________________________________________________________________________
inception_4a_3x3_reduce (Conv2D (None, 20, 8, 96)    46176       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a5x5_reduce (Conv2D) (None, 20, 8, 16)    7696        max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3_reduce_bn (Bat (None, 20, 8, 96)    384         inception_4a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4a5x5_reduce_bn (Batc (None, 20, 8, 16)    64          inception_4a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)  (None, 20, 8, 480)   0           max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1 (Conv2D)       (None, 20, 8, 192)   92352       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3 (Conv2D)       (None, 20, 8, 208)   179920      inception_4a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4a_5x5 (Conv2D)       (None, 20, 8, 48)    19248       inception_4a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4a_pool_proj (Conv2D) (None, 20, 8, 64)    30784       max_pooling2d_6[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1_bn (BatchNorma (None, 20, 8, 192)   768         inception_4a_1x1[0][0]           
__________________________________________________________________________________________________
inception_4a_3x3_bn (BatchNorma (None, 20, 8, 208)   832         inception_4a_3x3[0][0]           
__________________________________________________________________________________________________
inception_4a_5x5_bn (BatchNorma (None, 20, 8, 48)    192         inception_4a_5x5[0][0]           
__________________________________________________________________________________________________
inception_4a_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 20, 8, 512)   0           inception_4a_1x1_bn[0][0]        
                                                                 inception_4a_3x3_bn[0][0]        
                                                                 inception_4a_5x5_bn[0][0]        
                                                                 inception_4a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_3x3_reduce (Conv2D (None, 20, 8, 112)   57456       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3_reduce_bn (Bat (None, 20, 8, 112)   448         inception_4b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4b5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_1x1 (Conv2D)       (None, 20, 8, 160)   82080       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3 (Conv2D)       (None, 20, 8, 224)   226016      inception_4b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4b_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_7[0][0]            
__________________________________________________________________________________________________
inception_4b_1x1_bn (BatchNorma (None, 20, 8, 160)   640         inception_4b_1x1[0][0]           
__________________________________________________________________________________________________
inception_4b_3x3_bn (BatchNorma (None, 20, 8, 224)   896         inception_4b_3x3[0][0]           
__________________________________________________________________________________________________
inception_4b_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4b_5x5[0][0]           
__________________________________________________________________________________________________
inception_4b_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 20, 8, 512)   0           inception_4b_1x1_bn[0][0]        
                                                                 inception_4b_3x3_bn[0][0]        
                                                                 inception_4b_5x5_bn[0][0]        
                                                                 inception_4b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_3x3_reduce (Conv2D (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3_reduce_bn (Bat (None, 20, 8, 128)   512         inception_4c_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4c5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4c5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_1x1 (Conv2D)       (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3 (Conv2D)       (None, 20, 8, 256)   295168      inception_4c_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4c_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4c5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_8[0][0]            
__________________________________________________________________________________________________
inception_4c_1x1_bn (BatchNorma (None, 20, 8, 128)   512         inception_4c_1x1[0][0]           
__________________________________________________________________________________________________
inception_4c_3x3_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4c_3x3[0][0]           
__________________________________________________________________________________________________
inception_4c_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4c_5x5[0][0]           
__________________________________________________________________________________________________
inception_4c_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4c_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 20, 8, 512)   0           inception_4c_1x1_bn[0][0]        
                                                                 inception_4c_3x3_bn[0][0]        
                                                                 inception_4c_5x5_bn[0][0]        
                                                                 inception_4c_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_3x3_reduce (Conv2D (None, 20, 8, 144)   73872       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d5x5_reduce (Conv2D) (None, 20, 8, 32)    16416       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3_reduce_bn (Bat (None, 20, 8, 144)   576         inception_4d_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4d5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4d5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_9 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_1x1 (Conv2D)       (None, 20, 8, 112)   57456       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3 (Conv2D)       (None, 20, 8, 288)   373536      inception_4d_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4d_5x5 (Conv2D)       (None, 20, 8, 64)    51264       inception_4d5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_9[0][0]            
__________________________________________________________________________________________________
inception_4d_1x1_bn (BatchNorma (None, 20, 8, 112)   448         inception_4d_1x1[0][0]           
__________________________________________________________________________________________________
inception_4d_3x3_bn (BatchNorma (None, 20, 8, 288)   1152        inception_4d_3x3[0][0]           
__________________________________________________________________________________________________
inception_4d_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4d_5x5[0][0]           
__________________________________________________________________________________________________
inception_4d_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4d_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 20, 8, 528)   0           inception_4d_1x1_bn[0][0]        
                                                                 inception_4d_3x3_bn[0][0]        
                                                                 inception_4d_5x5_bn[0][0]        
                                                                 inception_4d_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_3x3_reduce (Conv2D (None, 20, 8, 160)   84640       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e5x5_reduce (Conv2D) (None, 20, 8, 32)    16928       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_reduce_bn (Bat (None, 20, 8, 160)   640         inception_4e_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4e5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4e5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 20, 8, 528)   0           concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_1x1 (Conv2D)       (None, 20, 8, 256)   135424      concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3 (Conv2D)       (None, 20, 8, 320)   461120      inception_4e_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4e_5x5 (Conv2D)       (None, 20, 8, 128)   102528      inception_4e5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_pool_proj (Conv2D) (None, 20, 8, 128)   67712       max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
inception_4e_1x1_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4e_1x1[0][0]           
__________________________________________________________________________________________________
inception_4e_3x3_bn (BatchNorma (None, 20, 8, 320)   1280        inception_4e_3x3[0][0]           
__________________________________________________________________________________________________
inception_4e_5x5_bn (BatchNorma (None, 20, 8, 128)   512         inception_4e_5x5[0][0]           
__________________________________________________________________________________________________
inception_4e_pool_proj_bn (Batc (None, 20, 8, 128)   512         inception_4e_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 20, 8, 832)   0           inception_4e_1x1_bn[0][0]        
                                                                 inception_4e_3x3_bn[0][0]        
                                                                 inception_4e_5x5_bn[0][0]        
                                                                 inception_4e_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_7[0][0]              
__________________________________________________________________________________________________
inception_5a_3x3_reduce (Conv2D (None, 10, 4, 160)   133280      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a5x5_reduce (Conv2D) (None, 10, 4, 32)    26656       max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_reduce_bn (Bat (None, 10, 4, 160)   640         inception_5a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5a5x5_reduce_bn (Batc (None, 10, 4, 32)    128         inception_5a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 10, 4, 832)   0           max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1 (Conv2D)       (None, 10, 4, 256)   213248      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3 (Conv2D)       (None, 10, 4, 320)   461120      inception_5a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5a_5x5 (Conv2D)       (None, 10, 4, 128)   102528      inception_5a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5a_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1_bn (BatchNorma (None, 10, 4, 256)   1024        inception_5a_1x1[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_bn (BatchNorma (None, 10, 4, 320)   1280        inception_5a_3x3[0][0]           
__________________________________________________________________________________________________
inception_5a_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5a_5x5[0][0]           
__________________________________________________________________________________________________
inception_5a_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 10, 4, 832)   0           inception_5a_1x1_bn[0][0]        
                                                                 inception_5a_3x3_bn[0][0]        
                                                                 inception_5a_5x5_bn[0][0]        
                                                                 inception_5a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_3x3_reduce (Conv2D (None, 10, 4, 192)   159936      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b5x5_reduce (Conv2D) (None, 10, 4, 48)    39984       concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3_reduce_bn (Bat (None, 10, 4, 192)   768         inception_5b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5b5x5_reduce_bn (Batc (None, 10, 4, 48)    192         inception_5b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1 (Conv2D)       (None, 10, 4, 384)   319872      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3 (Conv2D)       (None, 10, 4, 384)   663936      inception_5b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5b_5x5 (Conv2D)       (None, 10, 4, 128)   153728      inception_5b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 20, 8, 512)   2359808     concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_1x1[0][0]           
__________________________________________________________________________________________________
inception_5b_3x3_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_3x3[0][0]           
__________________________________________________________________________________________________
inception_5b_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5b_5x5[0][0]           
__________________________________________________________________________________________________
inception_5b_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5b_pool_proj[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 512)          0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 512)          0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 512)          0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 512)          0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 512)          0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 512)          0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 512)          0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 10, 4, 1024)  0           inception_5b_1x1_bn[0][0]        
                                                                 inception_5b_3x3_bn[0][0]        
                                                                 inception_5b_5x5_bn[0][0]        
                                                                 inception_5b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
low (Dense)                     (None, 3)            1539        global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
middle_hs (Dense)               (None, 3)            1539        global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
middle_ub (Dense)               (None, 9)            4617        global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
middle_lb (Dense)               (None, 6)            3078        global_average_pooling2d_4[0][0] 
__________________________________________________________________________________________________
middle_sh (Dense)               (None, 5)            2565        global_average_pooling2d_5[0][0] 
__________________________________________________________________________________________________
middle_at (Dense)               (None, 8)            4104        global_average_pooling2d_6[0][0] 
__________________________________________________________________________________________________
middle_ot (Dense)               (None, 3)            1539        global_average_pooling2d_7[0][0] 
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 10, 4, 1024)  9438208     concatenate_9[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 37)           0           low[0][0]                        
                                                                 middle_hs[0][0]                  
                                                                 middle_ub[0][0]                  
                                                                 middle_lb[0][0]                  
                                                                 middle_sh[0][0]                  
                                                                 middle_at[0][0]                  
                                                                 middle_ot[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 1024)         0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
high_cond (Dense)               (None, 14)           532         concatenate_10[0][0]             
__________________________________________________________________________________________________
high_fea (Dense)                (None, 14)           14350       global_average_pooling2d_8[0][0] 
__________________________________________________________________________________________________
high (Lambda)                   (None, 14)           0           high_cond[0][0]                  
                                                                 high_fea[0][0]                   
==================================================================================================
Total params: 32,431,351
Trainable params: 32,416,919
Non-trainable params: 14,432
__________________________________________________________________________________________________
320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_(e|f)1*
['320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch01_valloss3.52.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch04_valloss2.92.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch03_valloss3.01.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch07_valloss2.86.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_final50iter_model.h5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch02_valloss3.27.hdf5']
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch01_valloss3.52.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch04_valloss2.92.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch03_valloss3.01.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch07_valloss2.86.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_final50iter_model.h5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split1_iter50_epoch02_valloss3.27.hdf5_predictions_imagenet_test_RAP.npy
python test_RAP_hiarchical.py -m hiarBayesGoogLeNet_gap_v3 -c 51 -w 320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50 -g 1 -s 2
The shape of the X_test is:  (8317,)
The shape of the y_test is:  (8317, 51)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 320, 120, 3)  0                                            
__________________________________________________________________________________________________
conv1_7x7_s2 (Conv2D)           (None, 160, 60, 64)  9472        input_1[0][0]                    
__________________________________________________________________________________________________
conv1_7x7_s2_bn (BatchNormaliza (None, 160, 60, 64)  256         conv1_7x7_s2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 80, 30, 64)   0           conv1_7x7_s2_bn[0][0]            
__________________________________________________________________________________________________
conv2_3x3 (Conv2D)              (None, 80, 30, 192)  110784      max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_3x3_bn (BatchNormalizatio (None, 80, 30, 192)  768         conv2_3x3[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 40, 15, 192)  0           conv2_3x3_bn[0][0]               
__________________________________________________________________________________________________
inception_3a_3x3_reduce (Conv2D (None, 40, 15, 96)   18528       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a5x5_reduce (Conv2D) (None, 40, 15, 16)   3088        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_reduce_bn (Bat (None, 40, 15, 96)   384         inception_3a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3a5x5_reduce_bn (Batc (None, 40, 15, 16)   64          inception_3a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 15, 192)  0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1 (Conv2D)       (None, 40, 15, 64)   12352       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3 (Conv2D)       (None, 40, 15, 128)  110720      inception_3a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3a_5x5 (Conv2D)       (None, 40, 15, 32)   12832       inception_3a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3a_pool_proj (Conv2D) (None, 40, 15, 32)   6176        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1_bn (BatchNorma (None, 40, 15, 64)   256         inception_3a_1x1[0][0]           
__________________________________________________________________________________________________
inception_3a_3x3_bn (BatchNorma (None, 40, 15, 128)  512         inception_3a_3x3[0][0]           
__________________________________________________________________________________________________
inception_3a_5x5_bn (BatchNorma (None, 40, 15, 32)   128         inception_3a_5x5[0][0]           
__________________________________________________________________________________________________
inception_3a_pool_proj_bn (Batc (None, 40, 15, 32)   128         inception_3a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 15, 256)  0           inception_3a_1x1_bn[0][0]        
                                                                 inception_3a_3x3_bn[0][0]        
                                                                 inception_3a_5x5_bn[0][0]        
                                                                 inception_3a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_3x3_reduce (Conv2D (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b5x5_reduce (Conv2D) (None, 40, 15, 32)   8224        concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3_reduce_bn (Bat (None, 40, 15, 128)  512         inception_3b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3b5x5_reduce_bn (Batc (None, 40, 15, 32)   128         inception_3b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 40, 15, 256)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_1x1 (Conv2D)       (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3 (Conv2D)       (None, 40, 15, 192)  221376      inception_3b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3b_5x5 (Conv2D)       (None, 40, 15, 96)   76896       inception_3b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_pool_proj (Conv2D) (None, 40, 15, 64)   16448       max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
inception_3b_1x1_bn (BatchNorma (None, 40, 15, 128)  512         inception_3b_1x1[0][0]           
__________________________________________________________________________________________________
inception_3b_3x3_bn (BatchNorma (None, 40, 15, 192)  768         inception_3b_3x3[0][0]           
__________________________________________________________________________________________________
inception_3b_5x5_bn (BatchNorma (None, 40, 15, 96)   384         inception_3b_5x5[0][0]           
__________________________________________________________________________________________________
inception_3b_pool_proj_bn (Batc (None, 40, 15, 64)   256         inception_3b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 15, 480)  0           inception_3b_1x1_bn[0][0]        
                                                                 inception_3b_3x3_bn[0][0]        
                                                                 inception_3b_5x5_bn[0][0]        
                                                                 inception_3b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 20, 8, 480)   0           concatenate_2[0][0]              
__________________________________________________________________________________________________
inception_4a_3x3_reduce (Conv2D (None, 20, 8, 96)    46176       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a5x5_reduce (Conv2D) (None, 20, 8, 16)    7696        max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3_reduce_bn (Bat (None, 20, 8, 96)    384         inception_4a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4a5x5_reduce_bn (Batc (None, 20, 8, 16)    64          inception_4a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)  (None, 20, 8, 480)   0           max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1 (Conv2D)       (None, 20, 8, 192)   92352       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3 (Conv2D)       (None, 20, 8, 208)   179920      inception_4a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4a_5x5 (Conv2D)       (None, 20, 8, 48)    19248       inception_4a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4a_pool_proj (Conv2D) (None, 20, 8, 64)    30784       max_pooling2d_6[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1_bn (BatchNorma (None, 20, 8, 192)   768         inception_4a_1x1[0][0]           
__________________________________________________________________________________________________
inception_4a_3x3_bn (BatchNorma (None, 20, 8, 208)   832         inception_4a_3x3[0][0]           
__________________________________________________________________________________________________
inception_4a_5x5_bn (BatchNorma (None, 20, 8, 48)    192         inception_4a_5x5[0][0]           
__________________________________________________________________________________________________
inception_4a_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 20, 8, 512)   0           inception_4a_1x1_bn[0][0]        
                                                                 inception_4a_3x3_bn[0][0]        
                                                                 inception_4a_5x5_bn[0][0]        
                                                                 inception_4a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_3x3_reduce (Conv2D (None, 20, 8, 112)   57456       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3_reduce_bn (Bat (None, 20, 8, 112)   448         inception_4b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4b5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_1x1 (Conv2D)       (None, 20, 8, 160)   82080       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3 (Conv2D)       (None, 20, 8, 224)   226016      inception_4b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4b_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_7[0][0]            
__________________________________________________________________________________________________
inception_4b_1x1_bn (BatchNorma (None, 20, 8, 160)   640         inception_4b_1x1[0][0]           
__________________________________________________________________________________________________
inception_4b_3x3_bn (BatchNorma (None, 20, 8, 224)   896         inception_4b_3x3[0][0]           
__________________________________________________________________________________________________
inception_4b_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4b_5x5[0][0]           
__________________________________________________________________________________________________
inception_4b_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 20, 8, 512)   0           inception_4b_1x1_bn[0][0]        
                                                                 inception_4b_3x3_bn[0][0]        
                                                                 inception_4b_5x5_bn[0][0]        
                                                                 inception_4b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_3x3_reduce (Conv2D (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3_reduce_bn (Bat (None, 20, 8, 128)   512         inception_4c_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4c5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4c5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_1x1 (Conv2D)       (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3 (Conv2D)       (None, 20, 8, 256)   295168      inception_4c_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4c_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4c5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_8[0][0]            
__________________________________________________________________________________________________
inception_4c_1x1_bn (BatchNorma (None, 20, 8, 128)   512         inception_4c_1x1[0][0]           
__________________________________________________________________________________________________
inception_4c_3x3_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4c_3x3[0][0]           
__________________________________________________________________________________________________
inception_4c_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4c_5x5[0][0]           
__________________________________________________________________________________________________
inception_4c_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4c_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 20, 8, 512)   0           inception_4c_1x1_bn[0][0]        
                                                                 inception_4c_3x3_bn[0][0]        
                                                                 inception_4c_5x5_bn[0][0]        
                                                                 inception_4c_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_3x3_reduce (Conv2D (None, 20, 8, 144)   73872       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d5x5_reduce (Conv2D) (None, 20, 8, 32)    16416       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3_reduce_bn (Bat (None, 20, 8, 144)   576         inception_4d_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4d5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4d5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_9 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_1x1 (Conv2D)       (None, 20, 8, 112)   57456       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3 (Conv2D)       (None, 20, 8, 288)   373536      inception_4d_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4d_5x5 (Conv2D)       (None, 20, 8, 64)    51264       inception_4d5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_9[0][0]            
__________________________________________________________________________________________________
inception_4d_1x1_bn (BatchNorma (None, 20, 8, 112)   448         inception_4d_1x1[0][0]           
__________________________________________________________________________________________________
inception_4d_3x3_bn (BatchNorma (None, 20, 8, 288)   1152        inception_4d_3x3[0][0]           
__________________________________________________________________________________________________
inception_4d_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4d_5x5[0][0]           
__________________________________________________________________________________________________
inception_4d_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4d_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 20, 8, 528)   0           inception_4d_1x1_bn[0][0]        
                                                                 inception_4d_3x3_bn[0][0]        
                                                                 inception_4d_5x5_bn[0][0]        
                                                                 inception_4d_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_3x3_reduce (Conv2D (None, 20, 8, 160)   84640       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e5x5_reduce (Conv2D) (None, 20, 8, 32)    16928       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_reduce_bn (Bat (None, 20, 8, 160)   640         inception_4e_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4e5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4e5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 20, 8, 528)   0           concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_1x1 (Conv2D)       (None, 20, 8, 256)   135424      concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3 (Conv2D)       (None, 20, 8, 320)   461120      inception_4e_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4e_5x5 (Conv2D)       (None, 20, 8, 128)   102528      inception_4e5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_pool_proj (Conv2D) (None, 20, 8, 128)   67712       max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
inception_4e_1x1_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4e_1x1[0][0]           
__________________________________________________________________________________________________
inception_4e_3x3_bn (BatchNorma (None, 20, 8, 320)   1280        inception_4e_3x3[0][0]           
__________________________________________________________________________________________________
inception_4e_5x5_bn (BatchNorma (None, 20, 8, 128)   512         inception_4e_5x5[0][0]           
__________________________________________________________________________________________________
inception_4e_pool_proj_bn (Batc (None, 20, 8, 128)   512         inception_4e_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 20, 8, 832)   0           inception_4e_1x1_bn[0][0]        
                                                                 inception_4e_3x3_bn[0][0]        
                                                                 inception_4e_5x5_bn[0][0]        
                                                                 inception_4e_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_7[0][0]              
__________________________________________________________________________________________________
inception_5a_3x3_reduce (Conv2D (None, 10, 4, 160)   133280      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a5x5_reduce (Conv2D) (None, 10, 4, 32)    26656       max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_reduce_bn (Bat (None, 10, 4, 160)   640         inception_5a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5a5x5_reduce_bn (Batc (None, 10, 4, 32)    128         inception_5a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 10, 4, 832)   0           max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1 (Conv2D)       (None, 10, 4, 256)   213248      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3 (Conv2D)       (None, 10, 4, 320)   461120      inception_5a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5a_5x5 (Conv2D)       (None, 10, 4, 128)   102528      inception_5a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5a_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1_bn (BatchNorma (None, 10, 4, 256)   1024        inception_5a_1x1[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_bn (BatchNorma (None, 10, 4, 320)   1280        inception_5a_3x3[0][0]           
__________________________________________________________________________________________________
inception_5a_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5a_5x5[0][0]           
__________________________________________________________________________________________________
inception_5a_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 10, 4, 832)   0           inception_5a_1x1_bn[0][0]        
                                                                 inception_5a_3x3_bn[0][0]        
                                                                 inception_5a_5x5_bn[0][0]        
                                                                 inception_5a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_3x3_reduce (Conv2D (None, 10, 4, 192)   159936      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b5x5_reduce (Conv2D) (None, 10, 4, 48)    39984       concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3_reduce_bn (Bat (None, 10, 4, 192)   768         inception_5b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5b5x5_reduce_bn (Batc (None, 10, 4, 48)    192         inception_5b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1 (Conv2D)       (None, 10, 4, 384)   319872      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3 (Conv2D)       (None, 10, 4, 384)   663936      inception_5b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5b_5x5 (Conv2D)       (None, 10, 4, 128)   153728      inception_5b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 20, 8, 512)   2359808     concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_1x1[0][0]           
__________________________________________________________________________________________________
inception_5b_3x3_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_3x3[0][0]           
__________________________________________________________________________________________________
inception_5b_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5b_5x5[0][0]           
__________________________________________________________________________________________________
inception_5b_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5b_pool_proj[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 512)          0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 512)          0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 512)          0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 512)          0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 512)          0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 512)          0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 512)          0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 10, 4, 1024)  0           inception_5b_1x1_bn[0][0]        
                                                                 inception_5b_3x3_bn[0][0]        
                                                                 inception_5b_5x5_bn[0][0]        
                                                                 inception_5b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
low (Dense)                     (None, 3)            1539        global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
middle_hs (Dense)               (None, 3)            1539        global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
middle_ub (Dense)               (None, 9)            4617        global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
middle_lb (Dense)               (None, 6)            3078        global_average_pooling2d_4[0][0] 
__________________________________________________________________________________________________
middle_sh (Dense)               (None, 5)            2565        global_average_pooling2d_5[0][0] 
__________________________________________________________________________________________________
middle_at (Dense)               (None, 8)            4104        global_average_pooling2d_6[0][0] 
__________________________________________________________________________________________________
middle_ot (Dense)               (None, 3)            1539        global_average_pooling2d_7[0][0] 
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 10, 4, 1024)  9438208     concatenate_9[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 37)           0           low[0][0]                        
                                                                 middle_hs[0][0]                  
                                                                 middle_ub[0][0]                  
                                                                 middle_lb[0][0]                  
                                                                 middle_sh[0][0]                  
                                                                 middle_at[0][0]                  
                                                                 middle_ot[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 1024)         0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
high_cond (Dense)               (None, 14)           532         concatenate_10[0][0]             
__________________________________________________________________________________________________
high_fea (Dense)                (None, 14)           14350       global_average_pooling2d_8[0][0] 
__________________________________________________________________________________________________
high (Lambda)                   (None, 14)           0           high_cond[0][0]                  
                                                                 high_fea[0][0]                   
==================================================================================================
Total params: 32,431,351
Trainable params: 32,416,919
Non-trainable params: 14,432
__________________________________________________________________________________________________
320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_(e|f)1*
['320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch02_valloss3.25.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch03_valloss3.07.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch01_valloss3.39.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch02_valloss3.32.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch04_valloss2.96.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch06_valloss2.81.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch11_valloss2.81.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_final50iter_model.h5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch07_valloss2.94.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch01_valloss3.49.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch03_valloss3.02.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch10_valloss2.81.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch04_valloss2.89.hdf5']
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch02_valloss3.25.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch03_valloss3.07.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch01_valloss3.39.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch02_valloss3.32.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch04_valloss2.96.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch06_valloss2.81.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch11_valloss2.81.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_final50iter_model.h5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch07_valloss2.94.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch01_valloss3.49.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch03_valloss3.02.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch10_valloss2.81.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split2_iter50_epoch04_valloss2.89.hdf5_predictions_imagenet_test_RAP.npy
python test_RAP_hiarchical.py -m hiarBayesGoogLeNet_gap_v3 -c 51 -w 320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50 -g 1 -s 3
The shape of the X_test is:  (8317,)
The shape of the y_test is:  (8317, 51)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 320, 120, 3)  0                                            
__________________________________________________________________________________________________
conv1_7x7_s2 (Conv2D)           (None, 160, 60, 64)  9472        input_1[0][0]                    
__________________________________________________________________________________________________
conv1_7x7_s2_bn (BatchNormaliza (None, 160, 60, 64)  256         conv1_7x7_s2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 80, 30, 64)   0           conv1_7x7_s2_bn[0][0]            
__________________________________________________________________________________________________
conv2_3x3 (Conv2D)              (None, 80, 30, 192)  110784      max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_3x3_bn (BatchNormalizatio (None, 80, 30, 192)  768         conv2_3x3[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 40, 15, 192)  0           conv2_3x3_bn[0][0]               
__________________________________________________________________________________________________
inception_3a_3x3_reduce (Conv2D (None, 40, 15, 96)   18528       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a5x5_reduce (Conv2D) (None, 40, 15, 16)   3088        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_reduce_bn (Bat (None, 40, 15, 96)   384         inception_3a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3a5x5_reduce_bn (Batc (None, 40, 15, 16)   64          inception_3a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 15, 192)  0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1 (Conv2D)       (None, 40, 15, 64)   12352       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3 (Conv2D)       (None, 40, 15, 128)  110720      inception_3a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3a_5x5 (Conv2D)       (None, 40, 15, 32)   12832       inception_3a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3a_pool_proj (Conv2D) (None, 40, 15, 32)   6176        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1_bn (BatchNorma (None, 40, 15, 64)   256         inception_3a_1x1[0][0]           
__________________________________________________________________________________________________
inception_3a_3x3_bn (BatchNorma (None, 40, 15, 128)  512         inception_3a_3x3[0][0]           
__________________________________________________________________________________________________
inception_3a_5x5_bn (BatchNorma (None, 40, 15, 32)   128         inception_3a_5x5[0][0]           
__________________________________________________________________________________________________
inception_3a_pool_proj_bn (Batc (None, 40, 15, 32)   128         inception_3a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 15, 256)  0           inception_3a_1x1_bn[0][0]        
                                                                 inception_3a_3x3_bn[0][0]        
                                                                 inception_3a_5x5_bn[0][0]        
                                                                 inception_3a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_3x3_reduce (Conv2D (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b5x5_reduce (Conv2D) (None, 40, 15, 32)   8224        concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3_reduce_bn (Bat (None, 40, 15, 128)  512         inception_3b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3b5x5_reduce_bn (Batc (None, 40, 15, 32)   128         inception_3b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 40, 15, 256)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_1x1 (Conv2D)       (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3 (Conv2D)       (None, 40, 15, 192)  221376      inception_3b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3b_5x5 (Conv2D)       (None, 40, 15, 96)   76896       inception_3b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_pool_proj (Conv2D) (None, 40, 15, 64)   16448       max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
inception_3b_1x1_bn (BatchNorma (None, 40, 15, 128)  512         inception_3b_1x1[0][0]           
__________________________________________________________________________________________________
inception_3b_3x3_bn (BatchNorma (None, 40, 15, 192)  768         inception_3b_3x3[0][0]           
__________________________________________________________________________________________________
inception_3b_5x5_bn (BatchNorma (None, 40, 15, 96)   384         inception_3b_5x5[0][0]           
__________________________________________________________________________________________________
inception_3b_pool_proj_bn (Batc (None, 40, 15, 64)   256         inception_3b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 15, 480)  0           inception_3b_1x1_bn[0][0]        
                                                                 inception_3b_3x3_bn[0][0]        
                                                                 inception_3b_5x5_bn[0][0]        
                                                                 inception_3b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 20, 8, 480)   0           concatenate_2[0][0]              
__________________________________________________________________________________________________
inception_4a_3x3_reduce (Conv2D (None, 20, 8, 96)    46176       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a5x5_reduce (Conv2D) (None, 20, 8, 16)    7696        max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3_reduce_bn (Bat (None, 20, 8, 96)    384         inception_4a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4a5x5_reduce_bn (Batc (None, 20, 8, 16)    64          inception_4a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)  (None, 20, 8, 480)   0           max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1 (Conv2D)       (None, 20, 8, 192)   92352       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3 (Conv2D)       (None, 20, 8, 208)   179920      inception_4a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4a_5x5 (Conv2D)       (None, 20, 8, 48)    19248       inception_4a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4a_pool_proj (Conv2D) (None, 20, 8, 64)    30784       max_pooling2d_6[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1_bn (BatchNorma (None, 20, 8, 192)   768         inception_4a_1x1[0][0]           
__________________________________________________________________________________________________
inception_4a_3x3_bn (BatchNorma (None, 20, 8, 208)   832         inception_4a_3x3[0][0]           
__________________________________________________________________________________________________
inception_4a_5x5_bn (BatchNorma (None, 20, 8, 48)    192         inception_4a_5x5[0][0]           
__________________________________________________________________________________________________
inception_4a_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 20, 8, 512)   0           inception_4a_1x1_bn[0][0]        
                                                                 inception_4a_3x3_bn[0][0]        
                                                                 inception_4a_5x5_bn[0][0]        
                                                                 inception_4a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_3x3_reduce (Conv2D (None, 20, 8, 112)   57456       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3_reduce_bn (Bat (None, 20, 8, 112)   448         inception_4b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4b5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_1x1 (Conv2D)       (None, 20, 8, 160)   82080       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3 (Conv2D)       (None, 20, 8, 224)   226016      inception_4b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4b_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_7[0][0]            
__________________________________________________________________________________________________
inception_4b_1x1_bn (BatchNorma (None, 20, 8, 160)   640         inception_4b_1x1[0][0]           
__________________________________________________________________________________________________
inception_4b_3x3_bn (BatchNorma (None, 20, 8, 224)   896         inception_4b_3x3[0][0]           
__________________________________________________________________________________________________
inception_4b_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4b_5x5[0][0]           
__________________________________________________________________________________________________
inception_4b_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 20, 8, 512)   0           inception_4b_1x1_bn[0][0]        
                                                                 inception_4b_3x3_bn[0][0]        
                                                                 inception_4b_5x5_bn[0][0]        
                                                                 inception_4b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_3x3_reduce (Conv2D (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3_reduce_bn (Bat (None, 20, 8, 128)   512         inception_4c_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4c5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4c5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_1x1 (Conv2D)       (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3 (Conv2D)       (None, 20, 8, 256)   295168      inception_4c_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4c_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4c5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_8[0][0]            
__________________________________________________________________________________________________
inception_4c_1x1_bn (BatchNorma (None, 20, 8, 128)   512         inception_4c_1x1[0][0]           
__________________________________________________________________________________________________
inception_4c_3x3_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4c_3x3[0][0]           
__________________________________________________________________________________________________
inception_4c_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4c_5x5[0][0]           
__________________________________________________________________________________________________
inception_4c_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4c_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 20, 8, 512)   0           inception_4c_1x1_bn[0][0]        
                                                                 inception_4c_3x3_bn[0][0]        
                                                                 inception_4c_5x5_bn[0][0]        
                                                                 inception_4c_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_3x3_reduce (Conv2D (None, 20, 8, 144)   73872       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d5x5_reduce (Conv2D) (None, 20, 8, 32)    16416       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3_reduce_bn (Bat (None, 20, 8, 144)   576         inception_4d_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4d5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4d5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_9 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_1x1 (Conv2D)       (None, 20, 8, 112)   57456       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3 (Conv2D)       (None, 20, 8, 288)   373536      inception_4d_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4d_5x5 (Conv2D)       (None, 20, 8, 64)    51264       inception_4d5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_9[0][0]            
__________________________________________________________________________________________________
inception_4d_1x1_bn (BatchNorma (None, 20, 8, 112)   448         inception_4d_1x1[0][0]           
__________________________________________________________________________________________________
inception_4d_3x3_bn (BatchNorma (None, 20, 8, 288)   1152        inception_4d_3x3[0][0]           
__________________________________________________________________________________________________
inception_4d_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4d_5x5[0][0]           
__________________________________________________________________________________________________
inception_4d_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4d_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 20, 8, 528)   0           inception_4d_1x1_bn[0][0]        
                                                                 inception_4d_3x3_bn[0][0]        
                                                                 inception_4d_5x5_bn[0][0]        
                                                                 inception_4d_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_3x3_reduce (Conv2D (None, 20, 8, 160)   84640       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e5x5_reduce (Conv2D) (None, 20, 8, 32)    16928       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_reduce_bn (Bat (None, 20, 8, 160)   640         inception_4e_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4e5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4e5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 20, 8, 528)   0           concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_1x1 (Conv2D)       (None, 20, 8, 256)   135424      concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3 (Conv2D)       (None, 20, 8, 320)   461120      inception_4e_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4e_5x5 (Conv2D)       (None, 20, 8, 128)   102528      inception_4e5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_pool_proj (Conv2D) (None, 20, 8, 128)   67712       max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
inception_4e_1x1_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4e_1x1[0][0]           
__________________________________________________________________________________________________
inception_4e_3x3_bn (BatchNorma (None, 20, 8, 320)   1280        inception_4e_3x3[0][0]           
__________________________________________________________________________________________________
inception_4e_5x5_bn (BatchNorma (None, 20, 8, 128)   512         inception_4e_5x5[0][0]           
__________________________________________________________________________________________________
inception_4e_pool_proj_bn (Batc (None, 20, 8, 128)   512         inception_4e_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 20, 8, 832)   0           inception_4e_1x1_bn[0][0]        
                                                                 inception_4e_3x3_bn[0][0]        
                                                                 inception_4e_5x5_bn[0][0]        
                                                                 inception_4e_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_7[0][0]              
__________________________________________________________________________________________________
inception_5a_3x3_reduce (Conv2D (None, 10, 4, 160)   133280      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a5x5_reduce (Conv2D) (None, 10, 4, 32)    26656       max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_reduce_bn (Bat (None, 10, 4, 160)   640         inception_5a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5a5x5_reduce_bn (Batc (None, 10, 4, 32)    128         inception_5a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 10, 4, 832)   0           max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1 (Conv2D)       (None, 10, 4, 256)   213248      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3 (Conv2D)       (None, 10, 4, 320)   461120      inception_5a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5a_5x5 (Conv2D)       (None, 10, 4, 128)   102528      inception_5a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5a_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1_bn (BatchNorma (None, 10, 4, 256)   1024        inception_5a_1x1[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_bn (BatchNorma (None, 10, 4, 320)   1280        inception_5a_3x3[0][0]           
__________________________________________________________________________________________________
inception_5a_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5a_5x5[0][0]           
__________________________________________________________________________________________________
inception_5a_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 10, 4, 832)   0           inception_5a_1x1_bn[0][0]        
                                                                 inception_5a_3x3_bn[0][0]        
                                                                 inception_5a_5x5_bn[0][0]        
                                                                 inception_5a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_3x3_reduce (Conv2D (None, 10, 4, 192)   159936      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b5x5_reduce (Conv2D) (None, 10, 4, 48)    39984       concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3_reduce_bn (Bat (None, 10, 4, 192)   768         inception_5b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5b5x5_reduce_bn (Batc (None, 10, 4, 48)    192         inception_5b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1 (Conv2D)       (None, 10, 4, 384)   319872      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3 (Conv2D)       (None, 10, 4, 384)   663936      inception_5b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5b_5x5 (Conv2D)       (None, 10, 4, 128)   153728      inception_5b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 20, 8, 512)   2359808     concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_1x1[0][0]           
__________________________________________________________________________________________________
inception_5b_3x3_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_3x3[0][0]           
__________________________________________________________________________________________________
inception_5b_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5b_5x5[0][0]           
__________________________________________________________________________________________________
inception_5b_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5b_pool_proj[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 512)          0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 512)          0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 512)          0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 512)          0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 512)          0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 512)          0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 512)          0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 10, 4, 1024)  0           inception_5b_1x1_bn[0][0]        
                                                                 inception_5b_3x3_bn[0][0]        
                                                                 inception_5b_5x5_bn[0][0]        
                                                                 inception_5b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
low (Dense)                     (None, 3)            1539        global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
middle_hs (Dense)               (None, 3)            1539        global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
middle_ub (Dense)               (None, 9)            4617        global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
middle_lb (Dense)               (None, 6)            3078        global_average_pooling2d_4[0][0] 
__________________________________________________________________________________________________
middle_sh (Dense)               (None, 5)            2565        global_average_pooling2d_5[0][0] 
__________________________________________________________________________________________________
middle_at (Dense)               (None, 8)            4104        global_average_pooling2d_6[0][0] 
__________________________________________________________________________________________________
middle_ot (Dense)               (None, 3)            1539        global_average_pooling2d_7[0][0] 
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 10, 4, 1024)  9438208     concatenate_9[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 37)           0           low[0][0]                        
                                                                 middle_hs[0][0]                  
                                                                 middle_ub[0][0]                  
                                                                 middle_lb[0][0]                  
                                                                 middle_sh[0][0]                  
                                                                 middle_at[0][0]                  
                                                                 middle_ot[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 1024)         0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
high_cond (Dense)               (None, 14)           532         concatenate_10[0][0]             
__________________________________________________________________________________________________
high_fea (Dense)                (None, 14)           14350       global_average_pooling2d_8[0][0] 
__________________________________________________________________________________________________
high (Lambda)                   (None, 14)           0           high_cond[0][0]                  
                                                                 high_fea[0][0]                   
==================================================================================================
Total params: 32,431,351
Trainable params: 32,416,919
Non-trainable params: 14,432
__________________________________________________________________________________________________
320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_(e|f)1*
['320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch04_valloss2.97.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_final50iter_model.h5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch09_valloss2.78.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch05_valloss2.87.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch01_valloss3.49.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch08_valloss2.83.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch02_valloss3.13.hdf5']
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch04_valloss2.97.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_final50iter_model.h5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch09_valloss2.78.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch05_valloss2.87.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch01_valloss3.49.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch08_valloss2.83.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split3_iter50_epoch02_valloss3.13.hdf5_predictions_imagenet_test_RAP.npy
python test_RAP_hiarchical.py -m hiarBayesGoogLeNet_gap_v3 -c 51 -w 320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50 -g 1 -s 4
The shape of the X_test is:  (8317,)
The shape of the y_test is:  (8317, 51)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 320, 120, 3)  0                                            
__________________________________________________________________________________________________
conv1_7x7_s2 (Conv2D)           (None, 160, 60, 64)  9472        input_1[0][0]                    
__________________________________________________________________________________________________
conv1_7x7_s2_bn (BatchNormaliza (None, 160, 60, 64)  256         conv1_7x7_s2[0][0]               
__________________________________________________________________________________________________
max_pooling2d_1 (MaxPooling2D)  (None, 80, 30, 64)   0           conv1_7x7_s2_bn[0][0]            
__________________________________________________________________________________________________
conv2_3x3 (Conv2D)              (None, 80, 30, 192)  110784      max_pooling2d_1[0][0]            
__________________________________________________________________________________________________
conv2_3x3_bn (BatchNormalizatio (None, 80, 30, 192)  768         conv2_3x3[0][0]                  
__________________________________________________________________________________________________
max_pooling2d_2 (MaxPooling2D)  (None, 40, 15, 192)  0           conv2_3x3_bn[0][0]               
__________________________________________________________________________________________________
inception_3a_3x3_reduce (Conv2D (None, 40, 15, 96)   18528       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a5x5_reduce (Conv2D) (None, 40, 15, 16)   3088        max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3_reduce_bn (Bat (None, 40, 15, 96)   384         inception_3a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3a5x5_reduce_bn (Batc (None, 40, 15, 16)   64          inception_3a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_3 (MaxPooling2D)  (None, 40, 15, 192)  0           max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1 (Conv2D)       (None, 40, 15, 64)   12352       max_pooling2d_2[0][0]            
__________________________________________________________________________________________________
inception_3a_3x3 (Conv2D)       (None, 40, 15, 128)  110720      inception_3a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3a_5x5 (Conv2D)       (None, 40, 15, 32)   12832       inception_3a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3a_pool_proj (Conv2D) (None, 40, 15, 32)   6176        max_pooling2d_3[0][0]            
__________________________________________________________________________________________________
inception_3a_1x1_bn (BatchNorma (None, 40, 15, 64)   256         inception_3a_1x1[0][0]           
__________________________________________________________________________________________________
inception_3a_3x3_bn (BatchNorma (None, 40, 15, 128)  512         inception_3a_3x3[0][0]           
__________________________________________________________________________________________________
inception_3a_5x5_bn (BatchNorma (None, 40, 15, 32)   128         inception_3a_5x5[0][0]           
__________________________________________________________________________________________________
inception_3a_pool_proj_bn (Batc (None, 40, 15, 32)   128         inception_3a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 40, 15, 256)  0           inception_3a_1x1_bn[0][0]        
                                                                 inception_3a_3x3_bn[0][0]        
                                                                 inception_3a_5x5_bn[0][0]        
                                                                 inception_3a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_3x3_reduce (Conv2D (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b5x5_reduce (Conv2D) (None, 40, 15, 32)   8224        concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3_reduce_bn (Bat (None, 40, 15, 128)  512         inception_3b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_3b5x5_reduce_bn (Batc (None, 40, 15, 32)   128         inception_3b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_4 (MaxPooling2D)  (None, 40, 15, 256)  0           concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_1x1 (Conv2D)       (None, 40, 15, 128)  32896       concatenate_1[0][0]              
__________________________________________________________________________________________________
inception_3b_3x3 (Conv2D)       (None, 40, 15, 192)  221376      inception_3b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_3b_5x5 (Conv2D)       (None, 40, 15, 96)   76896       inception_3b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_3b_pool_proj (Conv2D) (None, 40, 15, 64)   16448       max_pooling2d_4[0][0]            
__________________________________________________________________________________________________
inception_3b_1x1_bn (BatchNorma (None, 40, 15, 128)  512         inception_3b_1x1[0][0]           
__________________________________________________________________________________________________
inception_3b_3x3_bn (BatchNorma (None, 40, 15, 192)  768         inception_3b_3x3[0][0]           
__________________________________________________________________________________________________
inception_3b_5x5_bn (BatchNorma (None, 40, 15, 96)   384         inception_3b_5x5[0][0]           
__________________________________________________________________________________________________
inception_3b_pool_proj_bn (Batc (None, 40, 15, 64)   256         inception_3b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 40, 15, 480)  0           inception_3b_1x1_bn[0][0]        
                                                                 inception_3b_3x3_bn[0][0]        
                                                                 inception_3b_5x5_bn[0][0]        
                                                                 inception_3b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_5 (MaxPooling2D)  (None, 20, 8, 480)   0           concatenate_2[0][0]              
__________________________________________________________________________________________________
inception_4a_3x3_reduce (Conv2D (None, 20, 8, 96)    46176       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a5x5_reduce (Conv2D) (None, 20, 8, 16)    7696        max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3_reduce_bn (Bat (None, 20, 8, 96)    384         inception_4a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4a5x5_reduce_bn (Batc (None, 20, 8, 16)    64          inception_4a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_6 (MaxPooling2D)  (None, 20, 8, 480)   0           max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1 (Conv2D)       (None, 20, 8, 192)   92352       max_pooling2d_5[0][0]            
__________________________________________________________________________________________________
inception_4a_3x3 (Conv2D)       (None, 20, 8, 208)   179920      inception_4a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4a_5x5 (Conv2D)       (None, 20, 8, 48)    19248       inception_4a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4a_pool_proj (Conv2D) (None, 20, 8, 64)    30784       max_pooling2d_6[0][0]            
__________________________________________________________________________________________________
inception_4a_1x1_bn (BatchNorma (None, 20, 8, 192)   768         inception_4a_1x1[0][0]           
__________________________________________________________________________________________________
inception_4a_3x3_bn (BatchNorma (None, 20, 8, 208)   832         inception_4a_3x3[0][0]           
__________________________________________________________________________________________________
inception_4a_5x5_bn (BatchNorma (None, 20, 8, 48)    192         inception_4a_5x5[0][0]           
__________________________________________________________________________________________________
inception_4a_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 20, 8, 512)   0           inception_4a_1x1_bn[0][0]        
                                                                 inception_4a_3x3_bn[0][0]        
                                                                 inception_4a_5x5_bn[0][0]        
                                                                 inception_4a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_3x3_reduce (Conv2D (None, 20, 8, 112)   57456       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3_reduce_bn (Bat (None, 20, 8, 112)   448         inception_4b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4b5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_7 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_1x1 (Conv2D)       (None, 20, 8, 160)   82080       concatenate_3[0][0]              
__________________________________________________________________________________________________
inception_4b_3x3 (Conv2D)       (None, 20, 8, 224)   226016      inception_4b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4b_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4b_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_7[0][0]            
__________________________________________________________________________________________________
inception_4b_1x1_bn (BatchNorma (None, 20, 8, 160)   640         inception_4b_1x1[0][0]           
__________________________________________________________________________________________________
inception_4b_3x3_bn (BatchNorma (None, 20, 8, 224)   896         inception_4b_3x3[0][0]           
__________________________________________________________________________________________________
inception_4b_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4b_5x5[0][0]           
__________________________________________________________________________________________________
inception_4b_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4b_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 20, 8, 512)   0           inception_4b_1x1_bn[0][0]        
                                                                 inception_4b_3x3_bn[0][0]        
                                                                 inception_4b_5x5_bn[0][0]        
                                                                 inception_4b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_3x3_reduce (Conv2D (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c5x5_reduce (Conv2D) (None, 20, 8, 24)    12312       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3_reduce_bn (Bat (None, 20, 8, 128)   512         inception_4c_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4c5x5_reduce_bn (Batc (None, 20, 8, 24)    96          inception_4c5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_8 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_1x1 (Conv2D)       (None, 20, 8, 128)   65664       concatenate_4[0][0]              
__________________________________________________________________________________________________
inception_4c_3x3 (Conv2D)       (None, 20, 8, 256)   295168      inception_4c_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4c_5x5 (Conv2D)       (None, 20, 8, 64)    38464       inception_4c5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4c_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_8[0][0]            
__________________________________________________________________________________________________
inception_4c_1x1_bn (BatchNorma (None, 20, 8, 128)   512         inception_4c_1x1[0][0]           
__________________________________________________________________________________________________
inception_4c_3x3_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4c_3x3[0][0]           
__________________________________________________________________________________________________
inception_4c_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4c_5x5[0][0]           
__________________________________________________________________________________________________
inception_4c_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4c_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 20, 8, 512)   0           inception_4c_1x1_bn[0][0]        
                                                                 inception_4c_3x3_bn[0][0]        
                                                                 inception_4c_5x5_bn[0][0]        
                                                                 inception_4c_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_3x3_reduce (Conv2D (None, 20, 8, 144)   73872       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d5x5_reduce (Conv2D) (None, 20, 8, 32)    16416       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3_reduce_bn (Bat (None, 20, 8, 144)   576         inception_4d_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4d5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4d5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_9 (MaxPooling2D)  (None, 20, 8, 512)   0           concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_1x1 (Conv2D)       (None, 20, 8, 112)   57456       concatenate_5[0][0]              
__________________________________________________________________________________________________
inception_4d_3x3 (Conv2D)       (None, 20, 8, 288)   373536      inception_4d_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4d_5x5 (Conv2D)       (None, 20, 8, 64)    51264       inception_4d5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4d_pool_proj (Conv2D) (None, 20, 8, 64)    32832       max_pooling2d_9[0][0]            
__________________________________________________________________________________________________
inception_4d_1x1_bn (BatchNorma (None, 20, 8, 112)   448         inception_4d_1x1[0][0]           
__________________________________________________________________________________________________
inception_4d_3x3_bn (BatchNorma (None, 20, 8, 288)   1152        inception_4d_3x3[0][0]           
__________________________________________________________________________________________________
inception_4d_5x5_bn (BatchNorma (None, 20, 8, 64)    256         inception_4d_5x5[0][0]           
__________________________________________________________________________________________________
inception_4d_pool_proj_bn (Batc (None, 20, 8, 64)    256         inception_4d_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 20, 8, 528)   0           inception_4d_1x1_bn[0][0]        
                                                                 inception_4d_3x3_bn[0][0]        
                                                                 inception_4d_5x5_bn[0][0]        
                                                                 inception_4d_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_3x3_reduce (Conv2D (None, 20, 8, 160)   84640       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e5x5_reduce (Conv2D) (None, 20, 8, 32)    16928       concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3_reduce_bn (Bat (None, 20, 8, 160)   640         inception_4e_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_4e5x5_reduce_bn (Batc (None, 20, 8, 32)    128         inception_4e5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_10 (MaxPooling2D) (None, 20, 8, 528)   0           concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_1x1 (Conv2D)       (None, 20, 8, 256)   135424      concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_4e_3x3 (Conv2D)       (None, 20, 8, 320)   461120      inception_4e_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_4e_5x5 (Conv2D)       (None, 20, 8, 128)   102528      inception_4e5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_4e_pool_proj (Conv2D) (None, 20, 8, 128)   67712       max_pooling2d_10[0][0]           
__________________________________________________________________________________________________
inception_4e_1x1_bn (BatchNorma (None, 20, 8, 256)   1024        inception_4e_1x1[0][0]           
__________________________________________________________________________________________________
inception_4e_3x3_bn (BatchNorma (None, 20, 8, 320)   1280        inception_4e_3x3[0][0]           
__________________________________________________________________________________________________
inception_4e_5x5_bn (BatchNorma (None, 20, 8, 128)   512         inception_4e_5x5[0][0]           
__________________________________________________________________________________________________
inception_4e_pool_proj_bn (Batc (None, 20, 8, 128)   512         inception_4e_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 20, 8, 832)   0           inception_4e_1x1_bn[0][0]        
                                                                 inception_4e_3x3_bn[0][0]        
                                                                 inception_4e_5x5_bn[0][0]        
                                                                 inception_4e_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
max_pooling2d_11 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_7[0][0]              
__________________________________________________________________________________________________
inception_5a_3x3_reduce (Conv2D (None, 10, 4, 160)   133280      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a5x5_reduce (Conv2D) (None, 10, 4, 32)    26656       max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_reduce_bn (Bat (None, 10, 4, 160)   640         inception_5a_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5a5x5_reduce_bn (Batc (None, 10, 4, 32)    128         inception_5a5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_12 (MaxPooling2D) (None, 10, 4, 832)   0           max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1 (Conv2D)       (None, 10, 4, 256)   213248      max_pooling2d_11[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3 (Conv2D)       (None, 10, 4, 320)   461120      inception_5a_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5a_5x5 (Conv2D)       (None, 10, 4, 128)   102528      inception_5a5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5a_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_12[0][0]           
__________________________________________________________________________________________________
inception_5a_1x1_bn (BatchNorma (None, 10, 4, 256)   1024        inception_5a_1x1[0][0]           
__________________________________________________________________________________________________
inception_5a_3x3_bn (BatchNorma (None, 10, 4, 320)   1280        inception_5a_3x3[0][0]           
__________________________________________________________________________________________________
inception_5a_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5a_5x5[0][0]           
__________________________________________________________________________________________________
inception_5a_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5a_pool_proj[0][0]     
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 10, 4, 832)   0           inception_5a_1x1_bn[0][0]        
                                                                 inception_5a_3x3_bn[0][0]        
                                                                 inception_5a_5x5_bn[0][0]        
                                                                 inception_5a_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_3x3_reduce (Conv2D (None, 10, 4, 192)   159936      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b5x5_reduce (Conv2D) (None, 10, 4, 48)    39984       concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3_reduce_bn (Bat (None, 10, 4, 192)   768         inception_5b_3x3_reduce[0][0]    
__________________________________________________________________________________________________
inception_5b5x5_reduce_bn (Batc (None, 10, 4, 48)    192         inception_5b5x5_reduce[0][0]     
__________________________________________________________________________________________________
max_pooling2d_13 (MaxPooling2D) (None, 10, 4, 832)   0           concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1 (Conv2D)       (None, 10, 4, 384)   319872      concatenate_8[0][0]              
__________________________________________________________________________________________________
inception_5b_3x3 (Conv2D)       (None, 10, 4, 384)   663936      inception_5b_3x3_reduce_bn[0][0] 
__________________________________________________________________________________________________
inception_5b_5x5 (Conv2D)       (None, 10, 4, 128)   153728      inception_5b5x5_reduce_bn[0][0]  
__________________________________________________________________________________________________
inception_5b_pool_proj (Conv2D) (None, 10, 4, 128)   106624      max_pooling2d_13[0][0]           
__________________________________________________________________________________________________
conv2d_1 (Conv2D)               (None, 20, 8, 512)   2359808     concatenate_3[0][0]              
__________________________________________________________________________________________________
conv2d_2 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_3 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_4 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_5 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_6 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
conv2d_7 (Conv2D)               (None, 20, 8, 512)   2433536     concatenate_6[0][0]              
__________________________________________________________________________________________________
inception_5b_1x1_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_1x1[0][0]           
__________________________________________________________________________________________________
inception_5b_3x3_bn (BatchNorma (None, 10, 4, 384)   1536        inception_5b_3x3[0][0]           
__________________________________________________________________________________________________
inception_5b_5x5_bn (BatchNorma (None, 10, 4, 128)   512         inception_5b_5x5[0][0]           
__________________________________________________________________________________________________
inception_5b_pool_proj_bn (Batc (None, 10, 4, 128)   512         inception_5b_pool_proj[0][0]     
__________________________________________________________________________________________________
global_average_pooling2d_1 (Glo (None, 512)          0           conv2d_1[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_2 (Glo (None, 512)          0           conv2d_2[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_3 (Glo (None, 512)          0           conv2d_3[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_4 (Glo (None, 512)          0           conv2d_4[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_5 (Glo (None, 512)          0           conv2d_5[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_6 (Glo (None, 512)          0           conv2d_6[0][0]                   
__________________________________________________________________________________________________
global_average_pooling2d_7 (Glo (None, 512)          0           conv2d_7[0][0]                   
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 10, 4, 1024)  0           inception_5b_1x1_bn[0][0]        
                                                                 inception_5b_3x3_bn[0][0]        
                                                                 inception_5b_5x5_bn[0][0]        
                                                                 inception_5b_pool_proj_bn[0][0]  
__________________________________________________________________________________________________
low (Dense)                     (None, 3)            1539        global_average_pooling2d_1[0][0] 
__________________________________________________________________________________________________
middle_hs (Dense)               (None, 3)            1539        global_average_pooling2d_2[0][0] 
__________________________________________________________________________________________________
middle_ub (Dense)               (None, 9)            4617        global_average_pooling2d_3[0][0] 
__________________________________________________________________________________________________
middle_lb (Dense)               (None, 6)            3078        global_average_pooling2d_4[0][0] 
__________________________________________________________________________________________________
middle_sh (Dense)               (None, 5)            2565        global_average_pooling2d_5[0][0] 
__________________________________________________________________________________________________
middle_at (Dense)               (None, 8)            4104        global_average_pooling2d_6[0][0] 
__________________________________________________________________________________________________
middle_ot (Dense)               (None, 3)            1539        global_average_pooling2d_7[0][0] 
__________________________________________________________________________________________________
conv2d_8 (Conv2D)               (None, 10, 4, 1024)  9438208     concatenate_9[0][0]              
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 37)           0           low[0][0]                        
                                                                 middle_hs[0][0]                  
                                                                 middle_ub[0][0]                  
                                                                 middle_lb[0][0]                  
                                                                 middle_sh[0][0]                  
                                                                 middle_at[0][0]                  
                                                                 middle_ot[0][0]                  
__________________________________________________________________________________________________
global_average_pooling2d_8 (Glo (None, 1024)         0           conv2d_8[0][0]                   
__________________________________________________________________________________________________
high_cond (Dense)               (None, 14)           532         concatenate_10[0][0]             
__________________________________________________________________________________________________
high_fea (Dense)                (None, 14)           14350       global_average_pooling2d_8[0][0] 
__________________________________________________________________________________________________
high (Lambda)                   (None, 14)           0           high_cond[0][0]                  
                                                                 high_fea[0][0]                   
==================================================================================================
Total params: 32,431,351
Trainable params: 32,416,919
Non-trainable params: 14,432
__________________________________________________________________________________________________
320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_(e|f)1*
['320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch05_valloss2.84.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch01_valloss3.87.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch06_valloss2.80.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch03_valloss3.05.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch02_valloss3.12.hdf5', '320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_final50iter_model.h5']
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch05_valloss2.84.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch01_valloss3.87.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch06_valloss2.80.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch03_valloss3.05.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_epoch02_valloss3.12.hdf5_predictions_imagenet_test_RAP.npy
(8317, 3)
(8317, 3)
(8317, 9)
(8317, 6)
(8317, 5)
(8317, 8)
(8317, 3)
(8317, 14)
The shape of the predictions_test is:  (8317, 51)
../results/predictions/hiarBayesGoogLeNet_gap_v3_320x120binary51_shuffleadam_newnewhier_oldreason_focalloss8multi2gamma_split4_iter50_final50iter_model.h5_predictions_imagenet_test_RAP.npy
